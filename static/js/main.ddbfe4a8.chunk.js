(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{156:function(e,t,a){e.exports={top:"InputButton_top__1PvaW",modal:"InputButton_modal__4hQtw"}},236:function(e,t,a){e.exports={top:"DeleteButton_top__dozsX"}},252:function(e,t,a){e.exports={top:"TopBar_top__1cepO"}},283:function(e,t,a){e.exports=a(570)},288:function(e,t,a){},297:function(e,t,a){},570:function(e,t,a){"use strict";a.r(t);var n,c=a(0),r=a.n(c),l=a(10),o=a.n(l),u=(a(288),a(289),a(290),a(291),a(292),a(293),a(294),a(295),a(296),a(297),a(58)),s=a(51),i={itemListByDate:{},totalList:[],valueList:[],scrollBottomEvt:0,isNavsDisplayed:!0},m=a(253),d=a(22);!function(e){e.PUT_ITEM="PUT_ITEM",e.DELETE_ITEM="DELETE_ITEM",e.LOAD_ITEMS="LOAD_ITEMS",e.SET_ITEMS="SET_ITEMS",e.PUT_TOTAL="PUT_TOTAL",e.LOAD_TOTALS="LOAD_TOTALS",e.SET_TOTALS="SET_TOTALS",e.CALC_TOTAL="CALC_TOTAL",e.SCROLL_BOTTOM="SCROLL_BOTTOM",e.SHOW_NAVS="SHOW_NAVS",e.HIDE_NAVS="HIDE_NAVS"}(n||(n={}));var E=a(16),f=a.n(E),p=a(17),O=a.n(p),y=function(e){return Math.floor(O()(e).local().hour()/6)},b=function(e,t){return O()(e).local().startOf("days").add(6*(t-1),"hours").format("YYYY-MM-DD")},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.SET_ITEMS:var a=t.payload.items,c=f.a.chain(a).groupBy(function(e){return b(e.date,e.timeRangeIndex)}).mapValues(function(e){return f.a.groupBy(e,"timeRangeIndex")}).value();return Object(d.a)({},e,{itemListByDate:c});case n.SET_TOTALS:var r=t.payload.totals,l=Object(m.a)(r);return Object(d.a)({},e,{totalList:l});case n.SCROLL_BOTTOM:return Object(d.a)({},e,{scrollBottomEvt:Date.now()});case n.SHOW_NAVS:return Object(d.a)({},e,{isNavsDisplayed:!0});case n.HIDE_NAVS:return Object(d.a)({},e,{isNavsDisplayed:!1});default:return e}},T=a(31),h=a.n(T),_=a(77),g=a(225),D=a(254),L=a(226),j=a(256),x=new(function(e){function t(){var e;return Object(g.a)(this,t),(e=Object(D.a)(this,Object(L.a)(t).call(this,"SainyoRecorderDatabase"))).items=void 0,e.totals=void 0,e.version(1).stores({items:"++id, date, datetime, timeRangeIndex,value",totals:"++id, date, timeRangeIndex, value, dateKey",values:"++id, value"}),e.items=e.table("items"),e.totals=e.table("totals"),e}return Object(j.a)(t,e),t}(a(227).a)),S=function(){var e=Object(_.a)(h.a.mark(function e(t,a){var c,r,l;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.date,r=a.timeRangeIndex,e.next=3,x.items.put(a);case 3:l={date:c,timeRangeIndex:r},t({type:n.CALC_TOTAL,payload:{query:l}}),t({type:n.LOAD_ITEMS});case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),I=function(){var e=Object(_.a)(h.a.mark(function e(t,a){var c,r,l,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.items.get(a);case 2:if(c=e.sent){e.next=5;break}return e.abrupt("return");case 5:return r=c.date,l=c.timeRangeIndex,o={date:r,timeRangeIndex:l},e.next=9,x.items.delete(a);case 9:t({type:n.CALC_TOTAL,payload:{query:o}}),t({type:n.LOAD_ITEMS});case 11:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),A=function(){var e=Object(_.a)(h.a.mark(function e(t){var a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.items.where("datetime").between(O()().local().startOf("days").subtract(3,"days").toDate(),O()().local().endOf("days").toDate()).sortBy("dattime");case 2:a=e.sent,t({type:n.SET_ITEMS,payload:{items:a}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(_.a)(h.a.mark(function e(t){var a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.totals.toArray();case 2:a=e.sent,t({type:n.SET_TOTALS,payload:{totals:a}}),t({type:n.SCROLL_BOTTOM});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(_.a)(h.a.mark(function e(t,a){var c,r,l,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.totals.get(Object(d.a)({},a));case 2:return c=e.sent,r=b(a.date,a.timeRangeIndex),e.next=6,x.items.where(Object(d.a)({},a)).toArray();case 6:return l=e.sent,o=f.a.sumBy(l,"value"),e.next=10,x.totals.put(Object(d.a)({},c,a,{value:o,dateKey:r}));case 10:t({type:n.LOAD_TOTALS});case 11:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),C=function(e,t,a){switch(e.type){case n.PUT_ITEM:return void S(t,e.payload.item);case n.DELETE_ITEM:return void I(t,e.payload.id);case n.LOAD_ITEMS:return void A(t);case n.CALC_TOTAL:return void M(t,e.payload.query);case n.LOAD_TOTALS:return void k(t)}},w=function(e,t,a,n){return function(c){t(c),a(c,n,e)}},N=Object(c.createContext)({state:i}),B=function(e){var t=e.children,a=function(e,t){var a=Object(s.a)(e,2),n=a[0],r=a[1],l=Object(c.useCallback)(function(e){o(e)},[]),o=Object(c.useCallback)(w(n,r,t,l),[n,r,l]);return[n,o]}(Object(c.useReducer)(v,i),C),l=Object(s.a)(a,2),o=l[0],u=l[1];Object(c.useEffect)(function(){u({type:n.LOAD_ITEMS}),u({type:n.LOAD_TOTALS})},[]);var m={state:o,dispatch:u};return r.a.createElement(N.Provider,{value:m},t)},R=a(234),K=a(38),H=a(233),Y=a.n(H),V=a(156),P=a.n(V),W=a(8),U=a.n(W),F=function(){var e=Object(c.useState)(!1),t=Object(s.a)(e,2),a=t[0],l=t[1],o=Object(c.useState)(new Date),u=Object(s.a)(o,2),i=u[0],m=u[1],d=Object(c.useState)(""),E=Object(s.a)(d,2),f=E[0],p=E[1],b=Object(c.useContext)(N).dispatch,v=Object(c.useCallback)(function(){m(new Date),l(!0),b&&b({type:n.HIDE_NAVS})},[l,b]),T=Object(c.useCallback)(function(){l(!1),b&&b({type:n.SHOW_NAVS})},[l,b]),h=Object(c.useCallback)(function(e){m(e)},[m]),_=Object(c.useCallback)(function(e){p(e)},[p]),g=Object(c.useCallback)(function(){var e=Number(f)||0;if(e>0&&b){var t={datetime:i,date:O()(i).format("YYYY-MM-DD"),value:e,timeRangeIndex:y(i)};b({type:n.PUT_ITEM,payload:{item:t}}),p(""),l(!1),b({type:n.SHOW_NAVS})}},[b,i,f,l]);return r.a.createElement("div",{className:U()(P.a.top)},r.a.createElement(R.a,{icon:"add",onClick:v}),r.a.createElement(K.e,{closable:!0,popup:!0,visible:a,animationType:"slide-up",onClose:T,className:U()(P.a.modal)},r.a.createElement(K.d,{renderHeader:"\u63a1\u5c3f\u91cf\u5165\u529b"},r.a.createElement(K.b,{locale:Y.a,value:i,onChange:h},r.a.createElement(K.d.Item,null,"\u65e5\u6642")),r.a.createElement(K.c,{type:"number",onChange:_,defaultValue:f,extra:"ml"},"\u63a1\u5c3f\u91cf"),r.a.createElement(K.d.Item,null,r.a.createElement(K.a,{onClick:g,type:"primary"},"\u767b\u9332")))))},q=a(57),J=a(15),z=a(255),Q=a(236),X=a.n(Q),$=function(e){var t=e.id,a=Object(c.useContext)(N).dispatch,l=Object(c.useCallback)(function(){t&&a&&a({type:n.DELETE_ITEM,payload:{id:t}})},[a,t]),o=Object(c.useCallback)(function(){K.e.alert("\u524a\u9664\u3057\u307e\u3059\u304b?","",[{text:"\u3044\u3044\u3048"},{text:"\u306f\u3044",onPress:l}])},[l]);return r.a.createElement(z.a,{className:X.a.top,icon:"delete",onClick:o})},G=function(e){var t=e.items,a=e.totals,n=e.hasDayTotal,l=e.dateKey,o=e.timeRangeIndex,u=e.hasBottomEl,s=Object(c.useContext)(N).state.scrollBottomEvt,i=Object(c.useRef)(null);Object(c.useEffect)(function(){i.current&&u&&i.current.scrollIntoView({behavior:"smooth"})},[i,s]);var m=f.a.find(a,{dateKey:l,timeRangeIndex:o}),d=NaN;return n&&(d=f.a.chain(a).filter({dateKey:l}).sumBy("value").value()),r.a.createElement(r.a.Fragment,null,t.map(function(e){return r.a.createElement(J.g,{key:e.datetime.getTime()},r.a.createElement(J.c,null,O()(e.datetime).local().format("MM/DD")),r.a.createElement(J.c,null,O()(e.datetime).local().format("HH:mm")),r.a.createElement(J.c,{alignEnd:!0},e.value),r.a.createElement(J.c,null,r.a.createElement($,{id:e.id})))}),m&&r.a.createElement(J.g,{className:"table-info"},r.a.createElement(J.c,null,O()(m.date).format("MM/DD")),r.a.createElement(J.c,null,function(e){return"".concat(O()().local().startOf("days").add(6*e,"hours").format("HH:mm"),"-").concat(O()().local().startOf("days").add(6*(e+1),"hours").format("HH:mm"))}(m.timeRangeIndex)),r.a.createElement(J.c,{alignEnd:!0},m.value),r.a.createElement(J.c,null)),!Number.isNaN(d)&&r.a.createElement(J.g,{className:"table-success",ref:i},r.a.createElement(J.c,null,O()(l).format("MM/DD")),r.a.createElement(J.c,null,"\u5408\u8a08(06:00-06:00)"),r.a.createElement(J.c,{alignEnd:!0},d),r.a.createElement(J.c,null)))},Z=function(){var e=Object(c.useContext)(N).state,t=e.totalList,a=e.itemListByDate,n=f.a.last(t),l=(n?n.dateKey:O()().local().format("YYYY-MM-DD"),[]);return f.a.isEmpty(a)||(l=f.a.chain(a).keys().sort().map(function(e){return{dateKey:e,items:a[e]}}).map(function(e){var t=e.dateKey,a=e.items,n=f.a.keys(a).length;return f.a.chain(a).keys().map(Number).sort(function(e,t){return 0===e?1:0===t?-1:e>t?1:e<t?-1:0}).map(function(e,c){return{dateKey:t,timeRangeIndex:e,items:a[e],hasDayTotal:c+1===n,hasBottomEl:!1}}).value()}).flatten().value(),f.a.set(f.a.last(l)||{},"hasBottomEl",!0)),r.a.createElement(J.a,{stickyRows:1,style:{height:"calc(100vh - 100px)"}},r.a.createElement(J.d,null,r.a.createElement(J.e,null,r.a.createElement(J.g,null,r.a.createElement(J.f,null,"\u65e5\u4ed8"),r.a.createElement(J.f,null,"\u6642\u9593"),r.a.createElement(J.f,null,"\u63a1\u5c3f\u91cf"),r.a.createElement(J.f,null))),r.a.createElement(J.b,null,l.map(function(e){return r.a.createElement(G,Object.assign({},e,{key:"".concat(e.dateKey,"-").concat(e.timeRangeIndex),totals:t}))}))))},ee=a(105),te=a(237),ae=a.n(te),ne=a(32),ce=function(){var e=ae()().width,t=Object(c.useContext)(N).state.totalList,a=f.a.chain(t).groupBy("dateKey").mapValues(function(e){return f.a.reduce(e,function(e,t){return Object(d.a)({},e,Object(ee.a)({},(a=t.timeRangeIndex,"".concat(6*a," - ").concat((a+1)%4*6)),t.value));var a},{})}).map(function(e,t){return Object(d.a)({dateKey:t,name:O()(t).format("MM/DD")},e)}).sortBy("dateKey").value();return r.a.createElement(ne.b,{width:e,height:e/2,data:a,margin:{top:20,right:20}},r.a.createElement(ne.c,{strokeDasharray:"3 3"}),r.a.createElement(ne.f,{dataKey:"name"}),r.a.createElement(ne.g,null),r.a.createElement(ne.e,null),r.a.createElement(ne.d,null),r.a.createElement(ne.a,{dataKey:"6 - 12",stackId:"a",fill:"#007bff"}),r.a.createElement(ne.a,{dataKey:"12 - 18",stackId:"a",fill:"#28a745"}),r.a.createElement(ne.a,{dataKey:"18 - 0",stackId:"a",fill:"#ffc107"}),r.a.createElement(ne.a,{dataKey:"0 - 6",stackId:"a",fill:"#17a2b8"}))},re=a(248),le=a.n(re),oe=a(249),ue=a.n(oe),se=function(){var e=Object(c.useContext)(N).state.totalList,t=f.a.chain(e).groupBy("dateKey").mapValues(function(e){return f.a.sumBy(e,"value")}).map(function(e,t){return{date:O()(t).toDate(),count:e}}).sortBy("date").value();console.log(t);var a=f.a.chain(t).maxBy("count").get("count").value()||1,n=Object(c.useCallback)(function(e){return{"data-tip":e.date?"[".concat(O()(e.date).format("YYYY/MM/DD"),"] ").concat(e.count," ml"):"","data-event":"click"}},[]),l=Object(c.useCallback)(function(e){return"color-github-".concat(Math.ceil(f.a.get(e,"count",0)/a*4))},[a]),o=O()().subtract(3,"month").toDate();return r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{startDate:o,showWeekdayLabels:!0,values:t,tooltipDataAttrs:n,monthLabels:f.a.range(1,13).map(String),weekdayLabels:["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],classForValue:l}),r.a.createElement(ue.a,{globalEventOff:"click"}))},ie=function(){return r.a.createElement(q.c,null,r.a.createElement(q.a,{exact:!0,path:"/",component:Z}),r.a.createElement(q.a,{path:"/chart",component:ce}),r.a.createElement(q.a,{path:"/heatmap",component:se}))},me=a(113),de=a(114),Ee=function(){return Object(c.useContext)(N).state.isNavsDisplayed?r.a.createElement("div",{className:"fixed-bottom"},r.a.createElement("ul",{className:"nav nav-pills nav-fill"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(u.b,{className:"nav-link",to:"/",exact:!0},r.a.createElement(me.a,{icon:de.c}))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(u.b,{to:"/chart",className:"nav-link"},r.a.createElement(me.a,{icon:de.b}))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(u.b,{to:"/heatmap",className:"nav-link"},r.a.createElement(me.a,{icon:de.a}))))):r.a.createElement(r.a.Fragment,null)},fe=a(78),pe=a(252),Oe=a.n(pe),ye=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(fe.a,{className:Oe.a.top},r.a.createElement(fe.c,null,r.a.createElement(fe.d,null,r.a.createElement(fe.e,null,"\u63a1\u5c3f\u91cf\u30ec\u30b3\u30fc\u30c0\u30fc")))),r.a.createElement(fe.b,null))},be=function(){return r.a.createElement(u.a,null,r.a.createElement(B,null,r.a.createElement(ye,null),r.a.createElement("div",{className:"container"},r.a.createElement(ie,null)),r.a.createElement(F,null),r.a.createElement(Ee,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[283,1,2]]]);
//# sourceMappingURL=main.ddbfe4a8.chunk.js.map