(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,a){},109:function(e,t,a){},190:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),l=a(9),o=a.n(l),u=(a(104),a(105),a(106),a(107),a(108),a(109),a(20)),i={itemList:[],totalList:[],valueList:[]},s=a(21),m=a(49);!function(e){e.PUT_ITEM="PUT_ITEM",e.LOAD_ITEMS="LOAD_ITEMS",e.SET_ITEMS="SET_ITEMS",e.PUT_TOTAL="PUT_TOTAL",e.LOAD_TOTALS="LOAD_TOTALS",e.SET_TOTALS="SET_TOTALS",e.CALC_TOTAL="CALC_TOTAL"}(n||(n={}));var d=a(26),f=a.n(d),O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.PUT_ITEM:var a=t.payload.item,r=f.a.sortBy([].concat(Object(m.a)(e.itemList),[a]),"datetime");return Object(s.a)({},e,{itemList:r});case n.SET_ITEMS:var c=t.payload.items,l=Object(m.a)(c);return Object(s.a)({},e,{itemList:l});case n.SET_TOTALS:var o=t.payload.totals,u=Object(m.a)(o);return Object(s.a)({},e,{totalList:u});default:return e}},T=a(28),E=a.n(T),p=a(47),v=a(83),b=a(95),y=a(84),h=a(96),L=new(function(e){function t(){var e;return Object(v.a)(this,t),(e=Object(b.a)(this,Object(y.a)(t).call(this,"SainyoRecorderDatabase"))).items=void 0,e.totals=void 0,e.version(1).stores({items:"++id, date, datetime, timeRangeIndex,value",totals:"++id, date, timeRangeIndex, value, dateKey",values:"++id, value"}),e.items=e.table("items"),e.totals=e.table("totals"),e}return Object(h.a)(t,e),t}(a(85).a)),j=a(10),A=a.n(j),_=function(e){return Math.floor(A()(e).local().hour()/6)},S=function(){var e=Object(p.a)(E.a.mark(function e(t){var a;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.items.orderBy("datetime").limit(30).toArray();case 2:a=e.sent,t({type:n.SET_ITEMS,payload:{items:a}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(p.a)(E.a.mark(function e(t){var a;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.totals.toArray();case 2:a=e.sent,t({type:n.SET_TOTALS,payload:{totals:a}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(p.a)(E.a.mark(function e(t,a){var r,c,l,o;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.totals.get(Object(s.a)({},a));case 2:return r=e.sent,u=a.date,i=a.timeRangeIndex,c=A()(u).local().startOf("days").add(6*(i-1),"hours").format("YYYY-MM-DD"),e.next=6,L.items.where(Object(s.a)({},a)).toArray();case 6:return l=e.sent,o=f.a.sumBy(l,"value"),e.next=10,L.totals.put(Object(s.a)({},r,a,{value:o,dateKey:c}));case 10:t({type:n.LOAD_TOTALS});case 11:case"end":return e.stop()}var u,i},e)}));return function(t,a){return e.apply(this,arguments)}}(),x=function(e,t,a){switch(e.type){case n.PUT_ITEM:var r=e.payload.item,c=r.date,l=r.timeRangeIndex;L.items.put(r);var o={date:c,timeRangeIndex:l};return void t({type:n.CALC_TOTAL,payload:{query:o}});case n.LOAD_ITEMS:return void S(t);case n.CALC_TOTAL:return void w(t,e.payload.query);case n.LOAD_TOTALS:return void M(t)}},D=function(e,t,a,n){return function(r){t(r),a(r,n,e)}},I=Object(r.createContext)({state:i}),g=function(e){var t=e.children,a=function(e,t){var a=Object(u.a)(e,2),n=a[0],c=a[1],l=Object(r.useCallback)(D(n,c,t,function(e){l(e)}),[n,c]);return[n,l]}(Object(r.useReducer)(O,i),x),l=Object(u.a)(a,2),o=l[0],s=l[1];Object(r.useEffect)(function(){s({type:n.LOAD_ITEMS}),s({type:n.LOAD_TOTALS})},[]);var m={state:o,dispatch:s};return c.a.createElement(I.Provider,{value:m},t)},C=function(){var e,t=Object(r.useContext)(I).state,a=t.itemList,n=t.totalList,l=f.a.last(n),o=l?l.dateKey:A()().local().format("YYYY-MM-DD"),u=f.a.chain(n).filter({dateKey:o}).sumBy("value").valueOf();return c.a.createElement("table",{className:"table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"\u65e5\u4ed8"),c.a.createElement("th",null,"\u6642\u9593"),c.a.createElement("th",{className:"text-right"},"\u63a1\u5c3f\u91cf"))),c.a.createElement("tbody",null,a.map(function(e){return c.a.createElement("tr",{key:e.datetime.getTime()},c.a.createElement("td",null,A()(e.datetime).local().format("MM/DD")),c.a.createElement("td",null,A()(e.datetime).local().format("HH:mm")),c.a.createElement("td",{className:"text-right"},e.value))}),l&&c.a.createElement(c.a.Fragment,null,c.a.createElement("tr",{className:"table-info"},c.a.createElement("td",null,A()(l.date).format("MM/DD")),c.a.createElement("td",null,(e=l.timeRangeIndex,"".concat(A()().local().startOf("days").add(6*e,"hours").format("HH:mm"),"-").concat(A()().local().startOf("days").add(6*(e+1),"hours").format("HH:mm")))),c.a.createElement("td",{className:"text-right"},l.value)),c.a.createElement("tr",{className:"table-success"},c.a.createElement("td",null,A()(l.dateKey).format("MM/DD")),c.a.createElement("td",null,"\u5408\u8a08(06:00-06:00)"),c.a.createElement("td",{className:"text-right"},u)))))},k=a(94),Y=a(22),N=a(91),P=a.n(N),R=a(92),B=a.n(R),H=a(8),U=a.n(H),K=function(){var e=Object(r.useState)(!1),t=Object(u.a)(e,2),a=t[0],l=t[1],o=Object(r.useState)(new Date),i=Object(u.a)(o,2),s=i[0],m=i[1],d=Object(r.useState)(""),f=Object(u.a)(d,2),O=f[0],T=f[1],E=Object(r.useContext)(I),p=(E.state,E.dispatch),v=Object(r.useCallback)(function(){m(new Date),l(!0)},[l]),b=Object(r.useCallback)(function(){l(!1)},[l]),y=Object(r.useCallback)(function(e){m(e)},[m]),h=Object(r.useCallback)(function(e){T(e)},[T]),L=Object(r.useCallback)(function(){var e=Number(O)||0;if(e>0&&p){var t={datetime:s,date:A()(s).format("YYYY-MM-DD"),value:e,timeRangeIndex:_(s)};p({type:n.PUT_ITEM,payload:{item:t}}),T(""),l(!1)}},[p,s,O,l]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(k.a,{icon:"add",onClick:v,className:U()(B.a.top)}),c.a.createElement(Y.e,{popup:!0,visible:a,animationType:"slide-up",onClose:b},c.a.createElement(Y.d,{renderHeader:"\u63a1\u5c3f\u91cf\u5165\u529b"},c.a.createElement(Y.b,{locale:P.a,value:s,onChange:y},c.a.createElement(Y.d.Item,null,"\u65e5\u6642")),c.a.createElement(Y.c,{type:"number",onChange:h,defaultValue:O},"\u63a1\u5c3f\u91cf"),c.a.createElement(Y.d.Item,null,c.a.createElement(Y.a,{onClick:L,type:"primary"},"\u767b\u9332")))))},W=function(){return c.a.createElement(g,null,c.a.createElement("div",{className:"container"},c.a.createElement("header",null,"\u63a1\u5c3f\u30ec\u30b3\u30fc\u30c0\u30fc"),c.a.createElement(C,null),c.a.createElement(K,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},92:function(e,t,a){e.exports={top:"InputButton_top__1PvaW"}},99:function(e,t,a){e.exports=a(190)}},[[99,1,2]]]);
//# sourceMappingURL=main.576d6d41.chunk.js.map